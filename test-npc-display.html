<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPC Display Test</title>
    <link rel="stylesheet" href="src/styles/index.css">
    <style>
        body { margin: 20px; font-family: Arial, sans-serif; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; background: #f9f9f9; }
        .test-header { background: #e0e0e0; padding: 10px; margin: -20px -20px 20px -20px; }
        .comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .old-style, .new-style { padding: 15px; border: 2px solid #ccc; }
        .old-style { background: #ffe6e6; }
        .new-style { background: #e6ffe6; }
    </style>
</head>
<body>
    <h1>NPC Card Display Test</h1>
    
    <div class="test-section">
        <div class="test-header">
            <h3>Current NPC Grid Layout Test</h3>
            <p>Testing if NPCs display in a proper grid (not one per row)</p>
        </div>
        
        <div id="npc-test-area" class="npc-list">
            <!-- NPCs will be populated here -->
        </div>
    </div>
    
    <div class="test-section">
        <div class="test-header">
            <h3>Data Comparison</h3>
            <p>Compare old vs new NPC card data display</p>
        </div>
        
        <div class="comparison">
            <div class="old-style">
                <h4>Original NPC Card Data</h4>
                <ul>
                    <li>✅ Name</li>
                    <li>✅ Location</li>
                    <li>✅ Role</li>
                    <li>✅ Description</li>
                    <li>✅ Secrets</li>
                    <li>✅ Motivations</li>
                    <li>❌ Abilities (not in original)</li>
                </ul>
            </div>
            
            <div class="new-style">
                <h4>Current NPC Card Data</h4>
                <ul id="current-data">
                    <li>Loading...</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <div class="test-header">
            <h3>Interactive Tests</h3>
        </div>
        
        <button onclick="testGridLayout()" style="padding: 10px 20px; margin: 5px;">Test Grid Layout</button>
        <button onclick="testDataDisplay()" style="padding: 10px 20px; margin: 5px;">Test Data Display</button>
        <button onclick="compareOriginal()" style="padding: 10px 20px; margin: 5px;">Compare with Original</button>
        
        <div id="test-results" style="margin-top: 20px; padding: 15px; background: #f0f0f0;"></div>
    </div>

    <script type="module">
        import { NpcCard } from './src/components/npc-card/npc-card.js';
        import { DataService } from './src/services/data-service.js';
        
        let npcCard, dataService;
        
        document.addEventListener('DOMContentLoaded', () => {
            try {
                dataService = new DataService();
                npcCard = new NpcCard();
                
                // Load NPCs immediately
                loadNpcs();
                
                // Update current data comparison
                updateDataComparison();
            } catch (error) {
                console.error('Initialization error:', error);
                document.getElementById('test-results').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        });
        
        function loadNpcs() {
            const container = document.getElementById('npc-test-area');
            
            try {
                const npcCards = npcCard.createAllCards();
                container.innerHTML = '';
                container.appendChild(npcCards);
                
                // Count displayed NPCs
                const cardCount = container.querySelectorAll('.npc-card').length;
                document.getElementById('test-results').innerHTML = `<p>✅ Loaded ${cardCount} NPC cards</p>`;
            } catch (error) {
                container.innerHTML = `<p style="color: red;">Error loading NPCs: ${error.message}</p>`;
            }
        }
        
        function updateDataComparison() {
            try {
                const npcs = dataService.getAllNpcs();
                const sampleNpc = npcs[0];
                
                const currentDataList = document.getElementById('current-data');
                currentDataList.innerHTML = `
                    <li>${sampleNpc.name ? '✅' : '❌'} Name</li>
                    <li>${sampleNpc.location ? '✅' : '❌'} Location</li>
                    <li>${sampleNpc.role ? '✅' : '❌'} Role</li>
                    <li>${sampleNpc.description ? '✅' : '❌'} Description</li>
                    <li>${sampleNpc.secrets ? '✅' : '❌'} Secrets</li>
                    <li>${sampleNpc.motivations ? '✅' : '❌'} Motivations</li>
                    <li>${sampleNpc.abilities ? '✅' : '❌'} Abilities</li>
                `;
            } catch (error) {
                console.error('Data comparison error:', error);
            }
        }
        
        window.testGridLayout = function() {
            const grid = document.querySelector('.npc-grid');
            const cards = document.querySelectorAll('.npc-card');
            
            if (grid && cards.length > 0) {
                const gridStyles = window.getComputedStyle(grid);
                const gridColumns = gridStyles.gridTemplateColumns;
                
                document.getElementById('test-results').innerHTML = `
                    <h4>Grid Layout Test Results:</h4>
                    <p><strong>Grid columns:</strong> ${gridColumns}</p>
                    <p><strong>NPC count:</strong> ${cards.length}</p>
                    <p><strong>Display:</strong> ${gridStyles.display}</p>
                    <p><strong>Status:</strong> ${gridColumns !== 'none' && gridStyles.display === 'grid' ? '✅ Grid working' : '❌ Grid broken'}</p>
                `;
            } else {
                document.getElementById('test-results').innerHTML = '<p style="color: red;">❌ No grid or cards found</p>';
            }
        };
        
        window.testDataDisplay = function() {
            const cards = document.querySelectorAll('.npc-card');
            let results = '<h4>Data Display Test:</h4>';
            
            if (cards.length > 0) {
                const firstCard = cards[0];
                const hasLocation = !!firstCard.querySelector('.npc-location');
                const hasSecrets = !!firstCard.querySelector('.npc-secrets');
                const hasMotivations = !!firstCard.querySelector('.npc-motivations');
                const hasAbilities = !!firstCard.querySelector('.npc-abilities');
                
                results += `
                    <p>Testing first NPC card:</p>
                    <ul>
                        <li>${hasLocation ? '✅' : '❌'} Location displayed</li>
                        <li>${hasSecrets ? '✅' : '❌'} Secrets section</li>
                        <li>${hasMotivations ? '✅' : '❌'} Motivations section</li>
                        <li>${hasAbilities ? '✅' : '❌'} Abilities section</li>
                    </ul>
                `;
            } else {
                results += '<p style="color: red;">❌ No cards found for testing</p>';
            }
            
            document.getElementById('test-results').innerHTML = results;
        };
        
        window.compareOriginal = function() {
            // Simulate original layout
            const originalHtml = `
                <div style="padding: 15px; border: 1px solid #ccc; margin: 10px 0; background: #ffe6e6;">
                    <h4>Original Style Example:</h4>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <h3 style="margin: 0; color: #8b7355;">Lord Bayard Scrimm</h3>
                        <span style="background: #8b7355; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">Thornwick Isle</span>
                    </div>
                    <div style="font-style: italic; color: #d4a574; margin-bottom: 10px;">Aristocratic Lord & Primary Antagonist</div>
                    <div style="margin-bottom: 10px;">Ancient aristocrat who has ruled Thornwick Isle for far longer than any mortal should...</div>
                    <div style="margin-bottom: 10px;">
                        <h4 style="color: #c62d42; margin: 0 0 5px 0;">Secrets:</h4>
                        <ul style="margin: 0; font-size: 0.9rem;">
                            <li>Body filled with writhing tentacled flesh</li>
                            <li>Feeds on the living</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: #d4a574; margin: 0 0 5px 0;">Motivations:</h4>
                        <ul style="margin: 0; font-size: 0.9rem;">
                            <li>Serve Agog's will</li>
                            <li>Maintain control over the bay</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('test-results').innerHTML = `
                <h4>Comparison:</h4>
                ${originalHtml}
                <p><strong>Current implementation should match this data richness and visual style.</strong></p>
            `;
        };
    </script>
</body>
</html>
